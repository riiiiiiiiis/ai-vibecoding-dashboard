export const MODULES = [
  { key: "basics", name: "ИИ — основы" },
  { key: "prompts", name: "Консоль промптов" },
  { key: "knowledge", name: "База знаний" },
];

export function getModuleOpenDate(moduleKey) {
  if (moduleKey === "prompts") return "20 августа";
  if (moduleKey === "knowledge") return "27 августа";
  return null;
}

export function getGuidesByModule(moduleKey) {
  if (moduleKey === "basics") {
    return [
      { title: "Дневной отчёт из 300 сообщений", desc: "Как собирать данные из Telegram/Discord, резюмировать и отправлять дайджест в канал.", time: "7 мин" },
      { title: "Консоль промптов: быстрые тесты", desc: "Структуры промптов, фиксация контекста, быстрые A/B проверки ответов.", time: "5 мин" },
      { title: "База знаний без боли", desc: "Загрузка PDF/Markdown, извлечение цитат, ссылки на источники, экспорт результатов.", time: "9 мин" },
    ];
  }
  if (moduleKey === "prompts") {
    return [
      { title: "Шаблоны промптов", desc: "Роль → Контекст → Задача → Формат → Ограничения → Критерии.", time: "6 мин" },
      { title: "A/B тесты подсказок", desc: "Сравнение вариантов при фиксированном вводе и метриках.", time: "4 мин" },
      { title: "Few‑shot примеры", desc: "Как подбирать и сокращать примеры для лучшего качества.", time: "5 мин" },
    ];
  }
  return [
    { title: "Импорт PDF/MD", desc: "Стратегии парсинга, нормализация и сегментация.", time: "6 мин" },
    { title: "Поиск по источникам", desc: "Ограничение контекста релевантными документами.", time: "5 мин" },
    { title: "Цитирование", desc: "Ссылки, страницы, якоря; экспорт результатов.", time: "5 мин" },
  ];
}

export function getAssignmentsByModule(moduleKey) {
  // Дедлайны: за день до начала следующего модуля
  // Модуль 1 (basics) => дедлайн 19 августа (если модуль 2 открывается 20),
  // Модуль 2 (prompts) => дедлайн 26 августа (если модуль 3 открывается 27)
  if (moduleKey === "basics") {
    return [
      {
        title: "Базовый уровень",
        desc:
          "Найдите 2–3 примера простых веб‑приложений, которыми вы пользуетесь каждый день (страница входа, калькулятор, форма обратной связи). Опишите функции и элементы UI. Подумайте, какие простые промпты могли бы быть использованы для создания их базовой структуры.",
        due: "2025‑08‑19",
        status: "Открыто",
      },
      {
        title: "Повышенный уровень",
        desc:
          "Сгенерируйте более сложное приложение (калькулятор, список задач или форму обратной связи) с помощью AI. Оцените точность и сформируйте дополнительные промпты для уточнения. Дополнительно попробуйте интегрировать внешний API (погода/цитаты) с описанием промптов.",
        due: "2025‑08‑19",
        status: "Открыто",
      },
    ];
  }
  if (moduleKey === "prompts") {
    return [
      {
        title: "Базовый уровень",
        desc:
          "Соберите шаблон промпта: роль, контекст, задача, формат ответа, ограничения, критерии. Подготовьте 2 примера (few‑shot).",
        due: "2025‑08‑26",
        status: "Открыто",
      },
      {
        title: "Повышенный уровень",
        desc:
          "Проведите A/B тест двух подсказок на фиксированном вводе. Опишите метрики и сформируйте выводы. При необходимости модернизируйте промпт.",
        due: "2025‑08‑26",
        status: "Открыто",
      },
    ];
  }
  return [
    {
      title: "Базовый уровень",
      desc:
        "Импортируйте 2 PDF и 1 MD, выделите 5 цитат с ссылками на источник. Оцените релевантность и оформите результат в Markdown.",
      due: "—",
      status: "Скоро",
    },
    {
      title: "Повышенный уровень",
      desc:
        "Настройте поиск по источникам. Подготовьте 3 ответа с цитатами и указанием страниц/якорей. Оцените качество и предложите улучшения.",
      due: "—",
      status: "Скоро",
    },
  ];
}

export function getTestsByModule(moduleKey, deps) {
  const { AssignmentItem, isHttpUrl, isLikelyEmail } = deps;
  if (moduleKey === "basics") {
    return [
      {
        name: "Компонент AssignmentItem",
        pass: typeof AssignmentItem === "function",
        qa: [
          { q: "Что делает AssignmentItem?", a: "Отображает карточку задания: описание, дедлайн, статус и кнопку 'Сдать'." },
          { q: "Как отправить задание?", a: "Нажмите 'Сдать' — вызывается onSubmit(title), открывается модал отправки." },
        ],
      },
      {
        name: "Валидатор URL",
        pass: isHttpUrl("https://x") && !isHttpUrl("ftp://x"),
        qa: [
          { q: "Какие URL валидны?", a: "Только http/https (начинаются с http:// или https://)." },
          { q: "Пример", a: "https://x — валиден; ftp://x — не валиден." },
        ],
      },
      {
        name: "Эвристика email",
        pass: isLikelyEmail("a@b.c") && !isLikelyEmail("bad"),
        qa: [
          { q: "Что проверяется?", a: "Наличие символов '@' и '.' — это упрощённая эвристика, не строгая валидация." },
          { q: "Пример", a: "a@b.c — валиден; bad — не валиден." },
        ],
      },
    ];
  }
  if (moduleKey === "prompts") {
    return [
      {
        name: "Базовые понятия: промпты",
        pass: true,
        qa: [
          { q: "Что такое промпт?", a: "Текстовая инструкция для модели: цель, контекст, формат ответа, ограничения." },
          { q: "Системный vs пользовательский промпт", a: "Системный задаёт правила/роль; пользовательский — конкретный запрос." },
          { q: "Что улучшает промпт?", a: "Ясность задачи, требования к формату, few‑shot примеры, критерии проверки." },
        ],
      },
      {
        name: "Шаблоны промптов",
        pass: true,
        qa: [
          { q: "Структура", a: "Роль → Контекст → Задача → Формат ответа → Ограничения → Критерии." },
          { q: "Пример", a: "'Ты редактор. Выровняй стиль текста, верни Markdown, без лишних комментариев.'" },
        ],
      },
      {
        name: "A/B тестирование подсказок",
        pass: true,
        qa: [
          { q: "Как сравнивать?", a: "Фиксируйте входные данные и критерии; меняйте один параметр за раз." },
          { q: "Метрики", a: "Согласованность формата, полнота ответа, субъективное качество, длина, время." },
        ],
      },
    ];
  }
  return [
    {
      name: "Импорт источников",
      pass: true,
      qa: [
        { q: "Что поддерживается?", a: "PDF, Markdown, текстовые фрагменты. Индексация по разделам." },
        { q: "Как цитировать?", a: "Храните ссылку на оригинал и якорь страницы/позиции." },
      ],
    },
    {
      name: "Поиск и фильтры",
      pass: true,
      qa: [
        { q: "Поиск по источникам", a: "Ограничивайте контекст релевантными документами и секциями." },
        { q: "Качество ответа", a: "Показывайте цитаты и источники, избегайте галлюцинаций." },
      ],
    },
    {
      name: "Проверка ссылок",
      pass: isHttpUrl("https://x") && !isHttpUrl("ftp://x"),
      qa: [
        { q: "Требования к ссылкам", a: "Только http/https; проверяйте доступность и формат." },
        { q: "Пример", a: "https://example.com — ок; ftp://example.com — нет." },
      ],
    },
  ];
}

export function getToolsByModule(moduleKey) {
  if (moduleKey === "basics") {
    return [
      {
        title: "Генератор промптов",
        desc: "Онлайн‑инструмент для генерации идей/подсказок.",
        href: "https://ai-idea-gen.vercel.app/",
      },
    ];
  }
  return [];
}

export function getLessonsByModule(moduleKey) {
  if (moduleKey === "basics") {
    return [
      { title: "Введение", time: "3 мин", desc: "О курсе и формате." },
      { title: "Интерфейс", time: "4 мин", desc: "Обзор приложения и основных разделов." },
      { title: "Промпты 101", time: "6 мин", desc: "Базовые принципы составления подсказок." },
      { title: "Чек‑лист качества", time: "5 мин", desc: "Критерии оценки ответа и улучшения." },
      { title: "Сбор данных", time: "4 мин", desc: "От источников к чистым данным." },
      { title: "Экспорт результатов", time: "3 мин", desc: "Markdown/CSV и шэринг." },
    ];
  }
  if (moduleKey === "prompts") {
    return [
      { title: "Шаблоны", time: "5 мин", desc: "Структура подсказок и роль." },
      { title: "A/B тест", time: "4 мин", desc: "Как сравнивать подсказки честно." },
    ];
  }
  return [
    { title: "Импорт", time: "5 мин", desc: "Поддерживаемые форматы и индексация." },
    { title: "Поиск", time: "4 мин", desc: "Фильтры и релевантность." },
  ];
}


