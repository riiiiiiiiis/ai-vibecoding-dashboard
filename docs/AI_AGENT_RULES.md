### Правила разработки для ИИ‑агентов (React/Vite/Tailwind)

Цель: обеспечить единый стиль и безопасные изменения. Технологическая база проекта: React 19, Vite 7, Tailwind CSS v4, ESM, Node >= 18.

### Архитектура и размещение файлов
- **Корень**: `public/`, `src/`, `README.md`, `package.json`, `vite.config.js`, `.gitignore`, (опц.) `tsconfig.*`, `.eslintrc.*`, `docs/`.
- **public/**: статические файлы, доступные по прямым URL. Не импортируются из кода. Пример: `public/index.html`, иконки.
- **src/**: весь исходный код приложения.
  - `src/assets/`: импортируемые ассеты (изображения, шрифты) — обрабатываются Vite.
  - `src/components/`: переиспользуемые UI‑компоненты (чистые, без бизнес‑логики).
  - `src/features/<домен>/`: функциональные модули по доменам. Внутри допускаются подпапки `components/`, `hooks/`, `services/`, `store/`, `types/`, `utils/`, `__tests__/`.
  - `src/hooks/`: общие кастомные хуки (не привязанные к домену).
  - `src/layouts/`: layout‑компоненты (Header, Footer, Sidebar и т.д.).
  - `src/pages/`: страницы (роуты). Внутри страницы используйте компоненты из `features/` и `components/`.
  - `src/services/`: внешние интеграции и API‑клиенты общего назначения.
  - `src/store/`: глобальное состояние (Context/Zustand/Redux) при необходимости.
  - `src/styles/`: глобальные стили и темы. Tailwind подключается через `src/index.css` (`@import "tailwindcss";`).
  - `src/types/`: общие типы/интерфейсы (при использовании TypeScript).
  - `src/utils/`: утилиты и константы общего назначения.
  - Вход: `src/main.jsx` (или `index.tsx` при TS), корневой компонент `src/app.tsx/tsx` при расширении.

Минимальный скелет фичи:
```
src/features/console/
  components/PromptConsole.jsx
  hooks/usePromptHistory.js
  services/consoleApi.js
  store/index.js
  utils/formatters.js
  __tests__/PromptConsole.test.jsx
```

### Именование и стиль кода
- **Файлы компонентов**: `PascalCase.jsx/tsx` (например, `PromptConsole.jsx`). Директории — `kebab-case`.
- **Компоненты**: функции в `PascalCase`. Хуки — с префиксом `use...`. Утилиты/переменные — говорящие названия (`formatDate`, `apiBaseUrl`).
- **Контроль потока**: ранние возвраты (guard clauses), избегать глубокой вложенности > 2–3 уровней.
- **Комментарии**: краткие, по делу; объясняют «почему», а не «как». Без TODO — делайте сразу.
- **Форматирование**: не переоформляйте несвязанный код. Длинные строки переносите. Избегайте сложных тернарных выражений.

### React‑практики
- **Композиция**: выносите повторяющиеся элементы в `src/components/`.
- **Состояние**: по умолчанию локальное (`useState`/`useReducer`). Глобальное — только при реальной необходимости (создавайте модуль в `src/store/`).
- **Мемоизация**: используйте `useMemo`/`useCallback` только при измеримой выгоде; не мемоизируйте без профита.
- **Разделение кода**: для крупных страниц/фич используйте `React.lazy` + `Suspense` и динамические `import()`.
- **Доступность**: aria‑атрибуты, фокус‑ловушки для модалок, корректные `role`, `alt` и т.д.

### Tailwind CSS v4
- **Подключение**: только через `@import "tailwindcss";` в `src/index.css`.
- **Предпочтение**: утилиты Tailwind вместо кастомного CSS. Общие паттерны — через `@layer` в `src/styles/`.
- **Тема/токены**: при необходимости используйте `@theme` для дизайн‑токенов. Не вносите глобальные стили в компоненты.
- **Дизайн‑ограничения проекта**: монохромная палитра (серые оттенки), JetBrains Mono, акценты — в hover ссылок, отсутствие «розового».

### Сервисы и API
- **Где**: `src/services/` или внутри `src/features/<домен>/services/`.
- **Конфигурация**: базовый URL и ключи — только через `import.meta.env.VITE_*`. Никогда не коммитьте секреты.
- **Клиент**: используйте `fetch` или легковесную обёртку. Функции — чистые, без побочных эффектов вне HTTP.
- **Ошибки**: корректная обработка, сообщения пользователю — нейтральные, без утечек внутренних деталей.

### Маршрутизация
- Если добавляете роутинг — держите конфигурацию в `src/router.*`. Страницы — в `src/pages/`. Код‑сплит по страницам обязателен.

### Тестирование
- Файлы тестов рядом (`*.test.jsx/tsx`) или в `__tests__/`.
- Юнит‑тесты для утилит и несложной логики компонентов. Для сложной UI‑логики — компонентные тесты.

### Безопасность
- Внешние ссылки: `rel="noopener noreferrer"` при `target="_blank"`.
- Ввод пользователя валидируйте (например, URL). Никогда не используйте `dangerouslySetInnerHTML` без санации.
- Переменные окружения не логируйте. Не загружайте посторонние скрипты с недоверенных доменов.

### Производительность
- Избегайте тяжёлых зависимостей. Перед добавлением — оценивайте размер бандла.
- Ленивая загрузка страниц/крупных фич. Избегайте ненужных ре‑рендеров (ключи списков, стабильные зависимости хуков).

### Git‑процесс
- **Ветки**: `feat/…`, `fix/…`, `chore/…`, `docs/…`, `refactor/…`.
- **Коммиты**: Conventional Commits (`feat: …`, `fix: …`). Один логический смысл — один PR.
- **Перед коммитом**: проект должен собираться (`npm run build`). Добавляете зависимости — фиксируйте `package.json` и `lockfile`.

### Процесс для ИИ‑агента
1) Прочитайте текущий код и найдите правильное место изменения (структура выше). Не дублируйте слои/директории.
2) Если требуется новая библиотека — сверяйтесь с актуальной документацией через Context7; ставьте последние стабильные версии.
3) Реализуйте минимально достаточный функционал, следуя архитектуре и стилю. Соблюдайте моно‑дизайн.
4) Обновите/добавьте короткую документацию (README/`docs/`) при изменении API/скриптов/структуры.
5) Запустите сборку (`npm run build`). Исправьте ошибки. Затем коммитните осмысленным сообщением.

### Запрещено
- Коммитить секреты/токены/`.env*`.
- Ломать существующий UI/паттерны доступности.
- Вносить крупные реорганизации без причины и без обновления документации.

### Примечания по TypeScript (если будет включён)
- Типизируйте публичные API компонентов и функции сервисов. Избегайте `any`.
- Общие типы — в `src/types/`. Для фич — локальные типы в модуле фичи.


